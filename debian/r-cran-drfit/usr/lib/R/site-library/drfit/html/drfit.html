<html><head><title>R: Fit dose-response models</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for drfit {drfit}"><tr><td>drfit {drfit}</td><td align="right">R Documentation</td></tr></table>
<h2>Fit dose-response models</h2>


<h3>Description</h3>

<p>
Fit dose-response relationships to dose-response data and calculate
biometric results for (eco)toxicity evaluation
</p>


<h3>Usage</h3>

<pre>
  drfit(data, startlogEC50 = NA, chooseone = TRUE, probit = TRUE, logit = FALSE,
    weibull = FALSE, linlogit = FALSE, linlogitWrong = NA, allWrong = NA, 
    s0 = 0.5, b0 = 2, f0 = 0)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>
A data frame containing dose-response data. The data frame has to
contain at least a factor called "substance", a vector called "unit"
containing the unit used for the dose, a column "response" with the
response values of the test system normalized between 0 and 1 and a column
"dose" with the numeric dose values. Such a data frame can be easily obtained
if a compliant RODBC data source is available for use in conjunction with 
the function <code><a href="drdata.html">drdata</a></code>.  
<br>
If there is a column called "ok" and it is set to "no fit" in a specific
line, then the corresponding data point will be excluded from the fitting
procedure, although it will be plotted.
</td></tr>
<tr valign="top"><td><code>startlogEC50</code></td>
<td>
Especially for the linlogit model, a suitable log10 of the EC50 has to be given 
by the user, since it is not correctly estimated for data showing hormesis with
the default estimation method.</td></tr>
<tr valign="top"><td><code>probit</code></td>
<td>
A boolean defining if cumulative density curves of normal distributions
<code><a href="../../stats/html/Normal.html">pnorm</a></code> are fitted against the decadic logarithm of the dose.
Default ist TRUE.</td></tr>
<tr valign="top"><td><code>logit</code></td>
<td>
A boolean defining if cumulative density curves of logistic distributions
<code><a href="../../stats/html/Logistic.html">plogis</a></code> are fitted to the decadic logarithm of the dose.
Default is FALSE.</td></tr>
<tr valign="top"><td><code>weibull</code></td>
<td>
A boolean defining if the cumulative density curves of weibull distributions
(<code><a href="../../stats/html/Weibull.html">pweibull</a></code> with additionall location parameter and scale=1)
are fitted to the decadic logarithm of the dose. Default is FALSE.</td></tr>
<tr valign="top"><td><code>linlogit</code></td>
<td>
A boolean defining if the linear-logistic function
<code><a href="linlogitf.html">linlogitf</a></code> as defined by van Ewijk and Hoekstra 1993 is
fitted to the data. Default is FALSE.</td></tr>
<tr valign="top"><td><code>linlogitWrong</code></td>
<td>
An optional vector containing the names of the substances for which the
linlogit function produces a wrong fit.</td></tr>
<tr valign="top"><td><code>allWrong</code></td>
<td>
An optional vector containing the names of the substances for which all
functions produce a wrong fit.</td></tr>
<tr valign="top"><td><code>chooseone</code></td>
<td>
If TRUE (default), the models are tried in the order linlogit, probit,
logit, weibull, and the first model that produces a valid fit is used.
If FALSE, all models that are set to TRUE and that can be fitted will be
reported.</td></tr>
<tr valign="top"><td><code>s0</code></td>
<td>
If the weibull model is fitted, s0 gives the possibility to adjust the
starting value for the shape parameter of <code><a href="../../stats/html/Weibull.html">pweibull</a></code>.</td></tr>
<tr valign="top"><td><code>b0,f0</code></td>
<td>
If the linearlogistic model is fitted, b0 and f0 give the possibility to
adjust the starting values for the parameters b and f.</td></tr>
</table>

<h3>Value</h3>

<table summary="R argblock">
<tr valign="top"><td><code>results</code></td>
<td>
A data frame containing at least one line for each substance. If the data
did not show a mean response &lt; 0.5 at the highest dose level, the
modeltype is set to "none".
Every successful fit is reported in one line. Parameters of the fitted
curves are only reported if the fitted EC50 is not higher than the
highest dose. 
<code>n</code> is the number of dose-response curves in the raw data (repetitions
in each point), <code>lld</code> is the decadic logarithm of the lowest dose and
<code>lhd</code> is the decadic logarithm of the highest dose.
For the "linlogit", "logit" and "probit" models, the parameter
<code>a</code> that is reported coincides with the logEC50, i.e the logEC50 is 
one of the model parameters that is being fitted, and therefore
a standard deviation <code>std</code> is reported for the logEC50. In the 
case of the "weibull" model, <code>a</code> is a location parameter.
Parameter <code>b</code> in the case of the "linlogit" fit is the variable
b from the <code><a href="linlogitf.html">linlogitf</a></code> function. In the case of "probit" fit
it is the standard deviation of the fitted normal distribution, in the case
of the "logit" fit it is the <code>scale</code> parameter in the <code><a href="../../stats/html/Logistic.html">plogis</a></code>
function, and in the "weibull" fit it is the <code>shape</code> parameter of the
fitted <code><a href="../../stats/html/Weibull.html">pweibull</a></code> function. Only the "linlogit" fit produces a 
third parameter <code>c</code> which is the variable f from the
<code><a href="linlogitf.html">linlogitf</a></code> function.</td></tr>
</table>

<h3>Author(s)</h3>

<p>
Johannes Ranke 
<a href="mailto:jranke@uni-bremen.de">jranke@uni-bremen.de</a> 
<a href="http://www.uft.uni-bremen.de/chemie/ranke">http://www.uft.uni-bremen.de/chemie/ranke</a>
</p>


<h3>Examples</h3>

<pre>
data(antifoul)
r &lt;- drfit(antifoul)
format(r,digits=2)
</pre>



<hr><div align="center">[Package <em>drfit</em> version 0.04-34 <a href="00Index.html">Index]</a></div>

</body></html>
